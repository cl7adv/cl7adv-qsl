<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QSL Server Pro - CL7ADV</title>
    <style>
        :root { --rojo: #D21034; --azul: #002A8F; --fondo: #0d1117; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--fondo); color: white; margin: 0; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        
        /* PORTADA GRABADA CL7ADV */
        .main-card { 
            width: 90%; max-width: 400px; background: #161b22; padding: 40px; 
            border-radius: 20px; border: 1px solid #30363d; text-align: center;
            position: relative; box-shadow: 0 10px 50px rgba(0,0,0,0.8);
        }
        .grabado { position: absolute; top: 10px; right: 20px; color: rgba(255,255,255,0.03); font-size: 3em; font-weight: 900; user-select: none; pointer-events: none; }
        
        .marca { color: var(--rojo); font-size: 2.2em; font-weight: bold; letter-spacing: 5px; cursor: pointer; }
        .sub { color: #8b949e; font-size: 0.8em; margin-bottom: 30px; letter-spacing: 1px; }

        input { 
            width: 100%; padding: 15px; border-radius: 8px; border: 2px solid #30363d;
            background: #010409; color: white; font-size: 22px; text-align: center;
            text-transform: uppercase; margin-bottom: 20px; box-sizing: border-box;
        }

        .btn-motor { 
            background: var(--rojo); color: white; width: 100%; padding: 18px; 
            border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px;
        }

        /* BUZÃ“N DE ENTREGA (OVERLAY) */
        .buzon {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(13, 17, 23, 0.95); z-index: 1000; flex-direction: column;
            align-items: center; justify-content: center; padding: 20px;
        }
        .qsl-img { max-width: 95%; max-height: 60vh; border: 3px solid #30363d; border-radius: 10px; }
        .controles { margin-top: 25px; display: flex; flex-direction: column; gap: 15px; width: 100%; max-width: 300px; }
        .btn-descarga { background: #238636; color: white; padding: 15px; border-radius: 8px; text-decoration: none; font-weight: bold; font-size: 1.1em; }
        .btn-volver { color: #8b949e; background: none; border: none; cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body>

    <div class="main-card">
        <div class="grabado">CL7ADV</div>
        <div class="marca" onclick="adminAccess()">CL7ADV</div>
        <div class="sub">SANTA CRUZ DEL SUR | CUBA</div>

        <p style="text-align: left; font-size: 0.8em; color: #8b949e;">ðŸ‘‰ Escriba su indicativo para procesar la descarga:</p>
        <input type="text" id="callsign" placeholder="CO2ABC" autocomplete="off">
        
        <button class="btn-motor" onclick="iniciarBuzon()">BUSCAR EN SERVIDOR</button>

        <p style="margin-top: 30px; font-size: 0.7em; color: #30363d;">COLABORADOR: CO5ABC | VER 2026.1</p>
    </div>

    <div id="pantalla" class="buzon">
        <h2 id="status">PROCESANDO...</h2>
        <div id="resultado"></div>
        <div class="controles">
            <div id="botonera"></div>
            <button class="btn-volver" onclick="cerrar()">VOLVER AL INICIO</button>
        </div>
    </div>

    <script>
        const CLAVE = "CUBA73";
        const DRIVE = "https://drive.google.com/drive/folders/1fJxjff9vtOR0SU7lq3lBHoGrGgvAUq1q";
        let clicks = 0;

        function adminAccess() {
            clicks++;
            if(clicks === 5) {
                const p = prompt("CÃ“DIGO DE AUTORIZACIÃ“N:");
                if(p === CLAVE) window.open(DRIVE, '_blank');
                clicks = 0;
            }
            setTimeout(() => clicks = 0, 2000);
        }

        function iniciarBuzon() {
            const ind = document.getElementById('callsign').value.toUpperCase().trim();
            if(!ind) return;

            const p = document.getElementById('pantalla');
            const res = document.getElementById('resultado');
            const st = document.getElementById('status');
            const bt = document.getElementById('botonera');

            p.style.display = 'flex';
            st.innerText = "LOCALIZANDO QSL...";
            res.innerHTML = "";
            bt.innerHTML = "";

            // BUSCAMOS EN LA CARPETA 'tarjetas' DE GITHUB
            const ruta = `tarjetas/${ind}.jpg`;
            const img = new Image();
            img.src = ruta;

            img.onload = function() {
                st.innerText = "Â¡ENCONTRADA!";
                res.innerHTML = `<img src="${ruta}" class="qsl-img">`;
                // El secreto de la descarga: usamos el atributo 'download'
                bt.innerHTML = `<a href="${ruta}" download="${ind}_QSL_CL7ADV.jpg" class="btn-descarga">ðŸ’¾ DESCARGAR AHORA</a>`;
            };

            img.onerror = function() {
                st.innerText = "NO ENCONTRADA";
                res.innerHTML = `<p style="color:#8b949e; text-align:center;">No hay archivos para <b>${ind}</b>.<br>Verifique que el operador haya subido el log.</p>`;
            };
        }

        function cerrar() {
            document.getElementById('pantalla').style.display = 'none';
        }
    </script>
</body>
</html>
