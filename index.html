<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QSL Caribe Pro - CL7ADV</title>
    <style>
        :root { --azul: #002A8F; --rojo: #D21034; --gris: #f4f4f4; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--gris); margin: 0; color: #333; }
        
        header { background: var(--azul); color: white; padding: 20px; text-align: center; border-bottom: 5px solid var(--rojo); position: relative; }
        .firma-secreta { font-size: 2.2em; font-weight: 900; letter-spacing: 4px; cursor: pointer; display: inline-block; }
        
        .contenedor { max-width: 1000px; margin: 30px auto; padding: 20px; text-align: center; }
        .buscador-latino { display: flex; max-width: 600px; margin: 0 auto 40px; background: white; border-radius: 50px; padding: 8px; border: 2px solid #ddd; }
        input { flex: 1; border: none; outline: none; padding: 10px 20px; font-size: 1.2em; text-transform: uppercase; border-radius: 50px; }
        .btn-lupa { background: var(--azul); color: white; border: none; padding: 10px 30px; border-radius: 50px; font-weight: bold; cursor: pointer; }

        /* MOSAICO ESTILO EHAMLOG */
        .mosaico { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .tarjeta-qsl { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border-bottom: 3px solid var(--rojo); transition: 0.3s; }
        .tarjeta-qsl:hover { transform: scale(1.02); }
        .tarjeta-qsl img { width: 100%; height: auto; display: block; cursor: pointer; background: #eee; min-height: 150px; }
        .info-qsl { padding: 12px; font-size: 0.9em; font-weight: bold; color: var(--azul); }

        /* MODAL DE DESCARGA */
        .ventana { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; flex-direction: column; }
        .ventana img { max-width: 90%; max-height: 70vh; border: 4px solid white; border-radius: 5px; }
        .controles { margin-top: 20px; display: flex; gap: 15px; }
        .btn-descargar { background: #28a745; color: white; padding: 15px 35px; border-radius: 5px; text-decoration: none; font-weight: bold; }
        .btn-cerrar { background: #666; color: white; padding: 15px 35px; border-radius: 5px; border: none; cursor: pointer; }
    </style>
</head>
<body>

    <header>
        <div class="firma-secreta" onclick="loginOculto()">CL7ADV</div>
        <div style="font-size: 0.8em; letter-spacing: 2px; margin-top: 5px;">SISTEMA PROFESIONAL DE QSL</div>
    </header>

    <div class="contenedor">
        <h2 style="color: var(--azul);">Buscar QSL / Certificados</h2>
        <div class="buscador-latino">
            <input type="text" id="indicativo" placeholder="EJ: CO2ABC" onkeyup="if(event.keyCode===13) procesarBusqueda()">
            <button class="btn-lupa" onclick="procesarBusqueda()">BUSCAR</button>
        </div>

        <div id="mosaico-resultados" class="mosaico">
            </div>
    </div>

    <div id="modalQSL" class="ventana">
        <img id="imgGrande">
        <div class="controles">
            <a id="enlaceBajar" class="btn-descargar" download>DESCARGAR AHORA</a>
            <button class="btn-cerrar" onclick="cerrar()">CERRAR</button>
        </div>
    </div>

    <footer>
        <p style="text-align: center; color: #888; margin-top: 50px;">Operado por CL7ADV • Colaboración: CO5ABC • 2026</p>
    </footer>

    <script>
        const MI_CLAVE = "CUBA73";
        let contador = 0;

        function loginOculto() {
            contador++;
            if(contador === 5) {
                const p = prompt("ACCESO ADMINISTRADOR:");
                if(p === MI_CLAVE) window.open("https://drive.google.com/drive/folders/1fJxjff9vtOR0SU7lq3lBHoGrGgvAUq1q", "_blank");
                contador = 0;
            }
            setTimeout(() => contador = 0, 3000);
        }

        async function procesarBusqueda() {
            const ind = document.getElementById('indicativo').value.toUpperCase().trim();
            const grid = document.getElementById('mosaico-resultados');
            if(!ind) return;

            grid.innerHTML = "<h4>Buscando archivos en el servidor...</h4>";
            
            // Intentamos buscar .jpg, .JPG, .png, .PNG
            const extensiones = ['jpg', 'JPG', 'png', 'PNG'];
            let encontradas = 0;
            grid.innerHTML = "";

            for(let ext of extensiones) {
                const ruta = `tarjetas/${ind}.${ext}`;
                const existe = await verificarImagen(ruta);
                
                if(existe) {
                    encontradas++;
                    grid.innerHTML += `
                        <div class="tarjeta-qsl">
                            <img src="${ruta}" onclick="verGrande('${ruta}')">
                            <div class="info-qsl">${ind}.${ext}</div>
                        </div>
                    `;
                }
            }

            if(encontradas === 0) {
                grid.innerHTML = `<p style="color:red;">No se encontró ninguna QSL para <b>${ind}</b>.<br>Verifique que el archivo esté en la carpeta /tarjetas.</p>`;
            }
        }

        function verificarImagen(url) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(true);
                img.onerror = () => resolve(false);
                img.src = url;
            });
        }

        function verGrande(src) {
            document.getElementById('imgGrande').src = src;
            document.getElementById('enlaceBajar').href = src;
            document.getElementById('modalQSL').style.display = 'flex';
        }

        function cerrar() {
            document.getElementById('modalQSL').style.display = 'none';
        }
    </script>
</body>
</html>
